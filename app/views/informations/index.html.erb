<center><h2>アプリ名</h2></center>

<div class="container today-info">
  <span class="box-title">地震情報</span>
  <% @informations.each do |information| %>
    <% if earthquakewarning(information.scale) %>
      <p class="warning"><%= information.disastertime %>&nbsp;&nbsp;&nbsp;&nbsp;<%= information.location %>で地震が発生しました!&nbsp;&nbsp;&nbsp;&nbsp;<%= earthquakescale(information.scale) %>&nbsp;&nbsp;&nbsp;&nbsp;<%= tsunamiscale(information.tsunami)  %></p>
    <% else  %>
      <p><%= information.disastertime %>&nbsp;&nbsp;&nbsp;&nbsp;<%= information.location %>で地震が発生しました!&nbsp;&nbsp;&nbsp;&nbsp;<%= earthquakescale(information.scale) %>&nbsp;&nbsp;&nbsp;&nbsp;<%= tsunamiscale(information.tsunami) %></p>
    <% end  %>
  <% end %>
    
</div>

<div id='map' class="container" ></div>

<script>
function initMap(){
  let map = new google.maps.Map(document.getElementById('map'), {
  center: {lat: 38.5, lng: 140},
  zoom: 5.3
  });
  
  //複数マーカー ここから
  <% @informations.each do |information| %>
    <% unless information.latitude == nil || information.longitude == nil %>
      (function(){
        var contentString = "住所：<%= information.location %>"; 
        var infowindow = new google.maps.InfoWindow({
            content: contentString
      });

        var marker = new google.maps.Marker({
          position:{lat: <%= information.latitude %>, lng: <%= information.longitude %>},
          map: map,
          title: contentString
        });

        marker.addListener('click', function() {
          infowindow.open(map, marker, content);
          });
        })();
    <% end %>
  <% end %>
  //複数マーカー ここまで  
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GMAPS_KEY']  %>&callback=initMap" async defer></script>